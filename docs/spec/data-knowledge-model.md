# Data & Knowledge Model

**Canonical Specification**
**Status:** CURRENT (as-built)
**Generated:** 2026-02-03

## 1. Identity

- **Name:** Data & Knowledge Model
- **Scope:** This specification defines the CURRENT state of data & knowledge model within ISA.
- **Marker:** CURRENT (as-built) â€” not ULTIMATE (ambition/research)

## 2. Core Sources

The following documents form the authoritative basis for this specification:

1. `./docs/GS1_Attribute_Mapper_Technical_Specification.md`
2. `./ARCHITECTURE.md`
3. `./docs/ISA_INFORMATION_ARCHITECTURE.md`
4. `./docs/PIPELINE_OBSERVABILITY_SPEC.md`
5. `./CHATGPT_PROMPT_BATCH_INGEST_02_04_05_06.md`
6. `./tasks/for_chatgpt/INGEST-02_gdsn_current.md`
7. `./CHATGPT_UPDATE_PROMPT.md`
8. `./DATA_MODEL.md`
9. `./docs/ADVISORY_OUTPUTS.md`
10. `./docs/CHATGPT_INTEGRATION_CONTRACT.md`

## 3. Definitions

*Terms used in this specification are defined in ISA_MASTER_SPEC.md*

## 4. Invariants (MUST-level)

**INV-1:** * Stores GDSN XML tags, EDI segments, and JSON-LD properties required for ESG compliance
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 1.2 Table 1: `gs1_attributes`

**INV-2:** * Links EU regulations to specific GS1 technical attributes required for compliance
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 1.3 Table 2: `regulation_attribute_mappings`

**INV-3:** "MANDATORY", // Legally required for compliance
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 1.3 Table 2: `regulation_attribute_mappings`

**INV-4:** "RECOMMENDED", // Best practice but not legally required
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 1.3 Table 2: `regulation_attribute_mappings`

**INV-5:** "CONDITIONAL", // Required only under specific circumstances
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 1.3 Table 2: `regulation_attribute_mappings`

**INV-6:** rationale: text("rationale").notNull(), // Explanation of why this attribute is required (e.g., "EUDR Article 9 requires geolocation data for all commodities")
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 1.3 Table 2: `regulation_attribute_mappings`

**INV-7:** 15,packagingMaterialTypeCode,Packaging Material Type Code,GDSN_XML,enum,true,<packagingMaterialTypeCode>,Packaging Information Module,,,,"Identifies the material type of packaging component. Must use 
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.2 Phase 1: Manual Curation (Week 1, 20 hours)

**INV-8:** 12,RFF+DDR,DDS Reference Number,EDI_SEGMENT,string,true,,,RFF+DDR,DDR,,"Unique ID generated by TRACES system upon submission of EUDR Due Diligence Statement. Must be linked to specific line items in D
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.2 Phase 1: Manual Curation (Week 1, 20 hours)

**INV-9:** required: boolean;
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.3 Phase 2: Automated GS1 Navigator Scraping (Week 2, 16 hours)

**INV-10:** isRequired: attr.required,
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.3 Phase 2: Automated GS1 Navigator Scraping (Week 2, 16 hours)

**INV-11:** 5,42,MANDATORY,"EUDR Article 9 requires geolocation data for all commodities. DDS Reference Number must be transmitted via EDI DESADV RFF segment.",2026-12-30,"[""food"",""timber"",""textiles""]",true
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.4 Phase 3: Regulation-to-Attribute Mapping (Week 2-3, 24 hours)

**INV-12:** 8,67,MANDATORY,"PPWR Article 11 mandates recyclability labeling. Packaging material type must be specified using granular codes (e.g., PET_TRANSPARENT vs. PET_OPAQUE) for Verpact fee calculation.",202
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.4 Phase 3: Regulation-to-Attribute Mapping (Week 2-3, 24 hours)

**INV-13:** Task: Identify which GS1 attributes are required, recommended, or optional for compliance with this regulation.
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.4 Phase 3: Regulation-to-Attribute Mapping (Week 2-3, 24 hours)

**INV-14:** Focus on attributes that are directly required by the regulation's legal text, not just "nice to have."`;
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.4 Phase 3: Regulation-to-Attribute Mapping (Week 2-3, 24 hours)

**INV-15:** required: ["attributeName", "requirementLevel", "rationale"],
- Source: `./docs/GS1_Attribute_Mapper_Technical_Specification.md` > 2.4 Phase 3: Regulation-to-Attribute Mapping (Week 2-3, 24 hours)

## 5. Interfaces / Pipelines / Entry Points

*CURRENT implementation details extracted from source documents.*

## 6. Governance & Change Control

Changes to this specification require:
1. Review of source documents
2. Update to TRACEABILITY_MATRIX.csv
3. Approval per ISA governance rules

## 7. Observability & Evaluation Hooks

**OPEN ISSUE:** Observability hooks not fully defined for this cluster.

## 8. Acceptance Criteria / IRON Gates

- AC-1: 3. **Validate:** Cross-reference with GS1 official documentation to ensure accuracy
- AC-2: it("should retrieve attributes by standard", async () => {
- AC-3: it("should retrieve attributes by technical format", async () => {
- AC-4: it("should search attributes by keyword", async () => {
- AC-5: it("should create regulation-attribute mapping", async () => {

## 9. Traceability Annex

| Claim ID | Statement (truncated) | Source |
|----------|----------------------|--------|
| DAT-001 | * Stores GDSN XML tags, EDI segments, and JSON-LD properties... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-002 | * Links EU regulations to specific GS1 technical attributes ... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-003 | "MANDATORY", // Legally required for compliance... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-004 | "RECOMMENDED", // Best practice but not legally required... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-005 | "CONDITIONAL", // Required only under specific circumstances... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-006 | rationale: text("rationale").notNull(), // Explanation of wh... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-007 | 3. **Validate:** Cross-reference with GS1 official documenta... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-008 | 15,packagingMaterialTypeCode,Packaging Material Type Code,GD... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-009 | 12,RFF+DDR,DDS Reference Number,EDI_SEGMENT,string,true,,,RF... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-010 | required: boolean;... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-011 | isRequired: attr.required,... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-012 | 5,42,MANDATORY,"EUDR Article 9 requires geolocation data for... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-013 | 8,67,MANDATORY,"PPWR Article 11 mandates recyclability label... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-014 | Task: Identify which GS1 attributes are required, recommende... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-015 | Focus on attributes that are directly required by the regula... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-016 | required: ["attributeName", "requirementLevel", "rationale"]... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-017 | required: ["mappings"],... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-018 | // Get attributes required for a specific regulation... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-019 | / `gs1Attributes.getByRegulation` / Query    / Public / Get ... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
| DAT-020 | This component displays GS1 attributes required for a specif... | `./docs/GS1_Attribute_Mapper_Technical_Specification.md` |
